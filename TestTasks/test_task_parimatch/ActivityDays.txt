# общее количество файлов - 165

#Таблица дат и кол-ва файлов

# ['02-01-18', 1]
# ['05-01-18', 4]
# ['12-01-18', 5]
# ['16-01-18', 2]
# ['19-01-18', 2]
# ['23-01-18', 3]
# ['26-01-18', 3]
# ['30-01-18', 6]
# ['02-02-18', 2]
# ['06-02-18', 3]
# ['13-02-18', 2]
# ['16-02-18', 2]
# ['20-02-18', 2]
# ['23-02-18', 1]
# ['27-02-18', 2]
# ['02-03-18', 2]
# ['06-03-18', 2]
# ['09-03-18', 8]
# ['13-03-18', 1]
# ['16-03-18', 4]
# ['20-03-18', 1]
# ['23-03-18', 2]
# ['27-03-18', 2]
# ['03-04-18', 1]
# ['10-04-18', 3]
# ['13-04-18', 1]
# ['17-04-18', 5]
# ['20-04-18', 1]
# ['27-04-18', 1]
# ['01-05-18', 1]
# ['04-05-18', 2]
# ['08-05-18', 2]
# ['11-05-18', 4]
# ['15-05-18', 3]
# ['18-05-18', 1]
# ['22-05-18', 3]
# ['25-05-18', 1]
# ['29-05-18', 2]
# ['01-06-18', 1]
# ['05-06-18', 6]
# ['08-06-18', 2]
# ['12-06-18', 2]
# ['22-06-18', 1]
# ['26-06-18', 2]
# ['29-06-18', 3]
# ['03-07-18', 2]
# ['06-07-18', 2]
# ['10-07-18', 2]
# ['13-07-18', 1]
# ['17-07-18', 2]
# ['20-07-18', 3]
# ['24-07-18', 2]
# ['27-07-18', 1]
# ['31-07-18', 2]
# ['03-08-18', 2]
# ['07-08-18', 3]
# ['10-08-18', 3]
# ['14-08-18', 1]
# ['17-08-18', 5]
# ['21-08-18', 2]
# ['24-08-18', 2]
# ['28-08-18', 4]
# ['31-08-18', 3]
# ['04-09-18', 2]
# ['07-09-18', 6]
# ['11-09-18', 6]
# ['14-09-18', 1]
# ['18-09-18', 2]
# ['21-09-18', 3]
# ['25-09-18', 6]
# ['28-09-18', 1]
# ['02-10-18', 4]
# ['05-10-18', 3]
# ['09-10-18', 1]
# ['12-10-18', 6]
# ['16-10-18', 2]
# ['19-10-18', 4]
# ['23-10-18', 3]
# ['26-10-18', 2]
# ['30-10-18', 1]
# ['02-11-18', 2]
# ['06-11-18', 5]
# ['09-11-18', 4]
# ['13-11-18', 1]
# ['16-11-18', 2]
# ['20-11-18', 1]
# ['23-11-18', 1]
# ['27-11-18', 1]
# ['30-11-18', 1]
# ['04-12-18', 4]
# ['18-12-18', 3]
# ['21-12-18', 2]
# ['28-12-18', 3]
# ['01-01-19', 3]
# ['08-01-19', 3]
# ['11-01-19', 1]
# ['15-01-19', 2]
# ['18-01-19', 1]
# ['22-01-19', 1]
# ['25-01-19', 2]
# ['29-01-19', 3]
# ['01-02-19', 3]
# ['05-02-19', 2]
# ['08-02-19', 4]
# ['12-02-19', 2]
# ['15-02-19', 4]
# ['19-02-19', 2]
# ['22-02-19', 2]
# ['26-02-19', 1]
# ['01-03-19', 2]
# ['05-03-19', 2]
# ['08-03-19', 1]
# ['19-03-19', 4]
# ['22-03-19', 1]
# ['26-03-19', 2]
# ['29-03-19', 1]
# ['09-04-19', 3]
# ['12-04-19', 2]
# ['16-04-19', 3]
# ['19-04-19', 1]
# ['23-04-19', 1]
# ['26-04-19', 2]
# ['03-05-19', 3]
# ['07-05-19', 1]
# ['14-05-19', 1]
# ['17-05-19', 1]
# ['21-05-19', 1]
# ['28-05-19', 5]
# ['31-05-19', 4]
# ['04-06-19', 2]
# ['11-06-19', 2]
# ['14-06-19', 3]
# ['18-06-19', 3]
# ['21-06-19', 1]
# ['25-06-19', 3]
# ['02-07-19', 1]
# ['05-07-19', 5]
# ['09-07-19', 4]
# ['12-07-19', 3]
# ['23-07-19', 3]
# ['26-07-19', 3]
# ['30-07-19', 2]
# ['02-08-19', 2]
# ['06-08-19', 5]
# ['09-08-19', 2]
# ['13-08-19', 1]
# ['16-08-19', 1]
# ['20-08-19', 3]
# ['23-08-19', 1]
# ['27-08-19', 1]
# ['30-08-19', 2]
# ['06-09-19', 2]
# ['10-09-19', 1]
# ['17-09-19', 2]
# ['20-09-19', 5]
# ['24-09-19', 3]
# ['27-09-19', 1]
# ['01-10-19', 2]
# ['04-10-19', 5]
# ['08-10-19', 3]
# ['11-10-19', 1]
# ['15-10-19', 7]
# ['18-10-19', 2]
# ['25-10-19', 2]
# ['01-11-19', 1]


# Скрипт


import pandas as pd
from datetime import date as dt
import sys
import os


def activity():


    # если путь к файлу не был передан аргументом из командной строки, предпологаем, что он лежит рядом со скриптом
    try:
        source_file = sys.argv[1]
    except ValueError:
        print('Argument wasn\'t sent. Use Activity_Days.csv by default')
    finally:
        source_file = 'Activity_Days.csv'

    # если файл не существует, вызываем исключение
    if not os.path.exists(source_file):
        raise FileExistsError(f"File {source_file} doesn't exist.")

    if not os.path.isdir('D:/Send_All'):  # проверяем, существует ли конечная дериктория. Если нет - создаем.
        try:
            os.mkdir('D:/Send_All')
        except FileExistsError:
            print('Directory D:/Send_All doesn\'t exist.')

    try:
        df = pd.read_csv(source_file, sep=';')
        df['Date'] = pd.to_datetime(df.Date, format='%d--%m--%Y')
    except ValueError:
        print('Format of the file is different')

    buffer = []
    for date in pd.date_range('2018-01-01', '2019-12-31'):  # можно указать dt.today()

        # Tuesday - 1, Friday - 4
        if dt.weekday(date) == 1 or dt.weekday(date) == 4:
            if buffer:
                with open(f'D:/Send_All/Send_{date.date().strftime("%d-%m-%y")}.csv', 'w') as f:
                    f.write(','.join(map(str, buffer)) + ',' + date.date().strftime("%d-%m-%y"))

                buffer.clear()

        if df[df.Date == str(date)]['id'].tolist():
            buffer += df[df.Date == str(date)]['id'].tolist()


if __name__ == '__main__':
    activity()